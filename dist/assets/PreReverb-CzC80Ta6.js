import{r as y,j as a}from"./index-Unzykuk8.js";import{l as x,o as A,a as N,m as R,k as _,q as v,_ as k,t as O,G as T,n as S,b as L,p as B,s as C}from"./stop-circle-DqqeZ05H.js";import{s as E,g as I,b as F,d as M,p as P,v as V}from"./VOCAL WITH VERB-DVYifobt.js";import{M as G}from"./Merge-DoBl48kR.js";import{E as w}from"./Effect-Dw3aVeLc.js";import"./CrossFade-Bq0s1Naa.js";class m extends x{constructor(){const e=A(m.getDefaults(),arguments,["type"]);super(e),this.name="Noise",this._source=null,this._playbackRate=e.playbackRate,this.type=e.type,this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut}static getDefaults(){return Object.assign(x.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(e){if(N(e in j,"Noise: invalid type: "+e),this._type!==e&&(this._type=e,this.state==="started")){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}_start(e){const t=j[this._type];this._source=new R({url:t,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(e),Math.random()*(t.duration-.001))}_stop(e){this._source&&(this._source.stop(this.toSeconds(e)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(e){this._stop(e),this._start(e)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const p=44100*5,b=2,h={brown:null,pink:null,white:null},j={get brown(){if(!h.brown){const l=[];for(let e=0;e<b;e++){const t=new Float32Array(p);l[e]=t;let s=0;for(let r=0;r<p;r++){const u=Math.random()*2-1;t[r]=(s+.02*u)/1.02,s=t[r],t[r]*=3.5}}h.brown=new _().fromArray(l)}return h.brown},get pink(){if(!h.pink){const l=[];for(let e=0;e<b;e++){const t=new Float32Array(p);l[e]=t;let s,r,u,c,n,o,i;s=r=u=c=n=o=i=0;for(let f=0;f<p;f++){const d=Math.random()*2-1;s=.99886*s+d*.0555179,r=.99332*r+d*.0750759,u=.969*u+d*.153852,c=.8665*c+d*.3104856,n=.55*n+d*.5329522,o=-.7616*o-d*.016898,t[f]=s+r+u+c+n+o+i+d*.5362,t[f]*=.11,i=d*.115926}}h.pink=new _().fromArray(l)}return h.pink},get white(){if(!h.white){const l=[];for(let e=0;e<b;e++){const t=new Float32Array(p);l[e]=t;for(let s=0;s<p;s++)t[s]=Math.random()*2-1}h.white=new _().fromArray(l)}return h.white}};class g extends w{constructor(){const e=A(g.getDefaults(),arguments,["decay"]);super(e),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve(),this._decay=e.decay,this._preDelay=e.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(w.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(e){e=this.toSeconds(e),v(e,.001),this._decay=e,this.generate()}get preDelay(){return this._preDelay}set preDelay(e){e=this.toSeconds(e),v(e,0),this._preDelay=e,this.generate()}generate(){return k(this,void 0,void 0,function*(){const e=this.ready,t=new O(2,this._decay+this._preDelay,this.context.sampleRate),s=new m({context:t}),r=new m({context:t}),u=new G({context:t});s.connect(u,0,0),r.connect(u,0,1);const c=new T({context:t}).toDestination();u.connect(c),s.start(0),r.start(0),c.gain.setValueAtTime(0,0),c.gain.setValueAtTime(1,this._preDelay),c.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const n=t.render();return this.ready=n.then(S),yield e,this._convolver.buffer=(yield n).get(),this})}dispose(){return super.dispose(),this._convolver.disconnect(),this}}const D=[{noteAllocation:"C4",fileLocation:E,sampleTitle:"Sunshine"},{noteAllocation:"D4",fileLocation:I,sampleTitle:"Guitar"},{noteAllocation:"E4",fileLocation:F,sampleTitle:"Bass"},{noteAllocation:"F4",fileLocation:M,sampleTitle:"Drums"},{noteAllocation:"G4",fileLocation:P,sampleTitle:"Piano"},{noteAllocation:"A5",fileLocation:V,sampleTitle:"Vocals"}],Q=()=>{const[l,e]=y.useState(!1),t=y.useRef(null),s=y.useRef(null);y.useEffect(()=>(t.current=new L(Object.fromEntries(D.map(n=>[n.noteAllocation,n.fileLocation])),{onload:()=>{e(!0)}}),s.current=new g({decay:1,preDelay:.25,wet:.5}).toDestination(),t.current&&s.current&&t.current.connect(s.current),()=>{t.current&&t.current.dispose(),s.current&&s.current.dispose()}),[]);const r=n=>{l&&t.current&&t.current.triggerAttack(n)},u=n=>{t.current&&t.current.triggerRelease(n)},c=(n,o,i)=>{s.current&&(s.current.decay=n,s.current.preDelay=o,s.current.wet.value=i)};return a.jsxs("div",{children:[a.jsx("h1",{children:"Reverb"}),a.jsx("p",{className:"blurb",children:"This is a more complex reverb with a pre delay setting."}),a.jsxs("div",{className:"audioComponentDisplay",children:[a.jsx("div",{className:"playerButtonBox",children:a.jsx("div",{children:D.map(n=>a.jsxs("div",{className:"playerButtonBox",children:[a.jsx("h2",{className:"sampleTitle",children:n.sampleTitle}),a.jsx("div",{onClick:()=>l&&r(n.noteAllocation),children:a.jsx("img",{src:B,alt:"Play",className:"buttons"})}),a.jsx("div",{onClick:()=>l&&u(n.noteAllocation),children:a.jsx("img",{src:C,alt:"Stop",className:"buttons"})})]},n.noteAllocation))})}),a.jsxs("div",{className:"paramDials",children:[a.jsxs("div",{className:"buttonSection",children:[a.jsxs("label",{children:["Decay (s): ",a.jsx("br",{}),a.jsx("input",{type:"range",min:"0",max:"5",step:"0.01",defaultValue:"2.5",onChange:n=>{var o,i;return c(parseFloat(n.target.value),((o=s.current)==null?void 0:o.preDelay)||1,((i=s.current)==null?void 0:i.wet.value)||.5)}})]}),a.jsx("div",{className:"explainer",children:"How big the space is supposed to sound"})]}),a.jsxs("div",{className:"buttonSection",children:[a.jsxs("label",{children:["Pre delay (s): ",a.jsx("br",{}),a.jsx("input",{type:"range",min:"0",max:"0.5",step:"0.01",defaultValue:"0.25",onChange:n=>{var o,i;return c(((o=s.current)==null?void 0:o.decay)||1,parseFloat(n.target.value),((i=s.current)==null?void 0:i.wet.value)||.5)}})]}),a.jsx("div",{className:"explainer",children:"Gives some reverb effect before source (Try on vocals!)"})]}),a.jsxs("div",{className:"buttonSection",children:[a.jsxs("label",{children:["Mix: ",a.jsx("br",{}),a.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",defaultValue:"0.5",onChange:n=>{var o,i;return c(((o=s.current)==null?void 0:o.decay)||1,((i=s.current)==null?void 0:i.preDelay)||1,parseFloat(n.target.value))}})]}),a.jsx("div",{className:"explainer",children:"The ratio of affected to unaffected sound"})]})]})]})]})};export{Q as default};
